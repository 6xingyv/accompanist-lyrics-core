package com.mocharealm.accompanist.lyrics.parser

import com.mocharealm.accompanist.lyrics.core.model.karaoke.KaraokeAlignment
import com.mocharealm.accompanist.lyrics.core.model.karaoke.KaraokeLine
import com.mocharealm.accompanist.lyrics.core.parser.KugouKrcParser
import kotlin.test.Test
import kotlin.test.assertEquals

class KugouParserTest {
    @Test
    fun testParseKugouKrcWithoutTranslation() {
        val krc = """
[id:$00000000]
[ar:三Z-STUDIO/HOYO-MiX]
[ti:覆灭重生 Come Alive]
[by:]
[hash:07cec452facb62cf627d50928d32b9bb]
[al:绝区零-覆灭重生 Come Alive]
[sign:]
[qq:]
[total:0]
[offset:0]
[language:eyJjb250ZW50IjpbeyJsYW5ndWFnZSI6MCwibHlyaWNDb250ZW50IjpbWyIgIl0sWyIgIl0sWyIgIl0sWyIgIl0sWyIgIl0sWyIgIl0sWyIgIl0sWyIgIl0sWyJcdThGRDhcdTgwRkQiXSxbIlx1NjJCNVx1NjI5N1x1NTkxQVx1NEU0NVx1RkYxRiJdLFsiXHU3NzNDXHU3NzBCXHU0RTAwXHU1MjA3XHU1RDI5XHU1ODRDIl0sWyJcdTRFMDdcdTcyNjlcdTZEODhcdTkwMUQiXSxbIlx1OTZCRVx1OTA1M1x1OEZERVx1NUI1OFx1NTcyOFx1NzY4NFx1NzVENVx1OEZGOSJdLFsiXHU0RTVGXHU3RUM4XHU1RjUyXHU0RThFXHU4NjVBXHU2NUUwXHVGRjFGIl0sWyJcdThGRDhcdTg5ODEiXSxbIlx1NkM4OVx1NkNBNlx1NTkxQVx1NEU0NVx1RkYxRiJdLFsiXHU2MjREXHU0RjFBXHU1RTYxXHU3MTM2XHU5MTkyXHU2MDlGIl0sWyJcdTY2RkVcdTdFQ0ZcdTc2ODRcdTY4QTZcdTVERjJcdTZFMTBcdTg4NENcdTZFMTBcdThGREMiXSxbIlx1ODk4MVx1OTY3N1x1ODFGM1x1NEY1NVx1NzlDRFx1N0VERFx1NTg4MyJdLFsiXHU2MjREXHU4MEZEXHU2NzA5XHU3ODM0XHU5MURDXHU2Qzg5XHU4MjFGXHU3Njg0XHU1MkM3XHU2QzE0XHVGRjFGIl0sWyJcdThCRTVcdTRGNTVcdTUzQkJcdTRGNTVcdTRFQ0UiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIiAiXSxbIlx1N0VDOFx1N0E3NiJdLFsiXHU1RkMzXHU0RTJEXHU3Njg0XHU3MDZCXHU0RUNFXHU2NzJBXHU3MTg0XHU3MDZEIl0sWyJcdTg5ODZcdTcwNkRcdTkxQ0RcdTc1MUYiXSxbIlx1NjIxMVx1NzBCOVx1NzFDM1x1OTFDRVx1NzA2Qlx1NTFCMlx1NjU2M1x1OUVEMVx1NTkxQyJdLFsiXHU1NzI4XHU2NUUwXHU1QzNEXHU3Njg0XHU2NzJBXHU3N0U1XHU0RTJEXHU2MjdFXHU1QkZCXHU4MUVBXHU1REYxIl0sWyJcdThGRkRcdTkwMTBcdTc3NDBcdTY2MUZcdTVCQkZcdTU0OENcdTUxNDkiXSxbIlx1NzUyOFx1NUMzRFx1NTE2OFx1NTI5Qlx1NTk1NFx1OEREMVx1OEZGRFx1NUJGQiJdLFsiXHU5MEEzXHU4RkY3XHU1OTMxXHU1NzI4XHU3QTdBXHU2RDFFXHU5MUNDXHU3Njg0XHU3NzFGXHU3NDA2Il0sWyJcdTU0RUFcdTYwMTVcdTUyNERcdTkwMTRcdTgzNDZcdTY4RDhcdTZGMkJcdTZGMkIiXSxbIlx1NjIxMVx1NEVFQ1x1N0VDOFx1NUMwNlx1NTFCMlx1NzgzNFx1NEUwMFx1NTIwN1x1OTYzQlx1Nzg4RFx1MDBBMFx1NjIxMVx1NzY4NFx1NEYxOVx1NEYzNCJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiICJdLFsiXHU4OTg2XHU3MDZEXHU5MUNEXHU3NTFGIl0sWyJcdTYyMTFcdTcwQjlcdTcxQzNcdTkxQ0VcdTcwNkJcdTUxQjJcdTY1NjNcdTlFRDFcdTU5MUMiXSxbIlx1NTcyOFx1NjVFMFx1NUMzRFx1NzY4NFx1NjcyQVx1NzdFNVx1NEUyRFx1NjI3RVx1NUJGQlx1ODFFQVx1NURGMSJdLFsiXHU4RkZEXHU5MDEwXHU3NzQwXHU2NjFGXHU1QkJGXHU1NDhDXHU1MTQ5Il0sWyJcdTc1MjhcdTVDM0RcdTUxNjhcdTUyOUJcdTU5NTRcdThERDFcdThGRkRcdTVCRkIiXSxbIlx1OTBBM1x1OEZGN1x1NTkzMVx1NTcyOFx1N0E3QVx1NkQxRVx1OTFDQ1x1NzY4NFx1NzcxRlx1NzQwNiJdLFsiXHU1NEVBXHU2MDE1XHU1MjREXHU5MDE0XHU4MzQ2XHU2OEQ4XHU2RjJCXHU2RjJCIl0sWyJcdTYyMTFcdTRFRUNcdTdFQzhcdTVDMDZcdTUxQjJcdTc4MzRcdTRFMDBcdTUyMDdcdTk2M0JcdTc4OERcdTAwQTBcdTYyMTFcdTc2ODRcdTRGMTlcdTRGMzQiXSxbIlx1N0VFN1x1N0VFRFx1NTk1NFx1OEREMVx1MDBBMFx1N0E3Rlx1OEQ4QVx1OThDRVx1NjZCNFx1MDBBMFx1NTcyOFx1OThDRVx1NzczQ1x1NEU0Qlx1NEUyRFx1NjI3RVx1NTIzMFx1NUI4MVx1OTc1OSJdLFsiICJdLFsiXHU3RUU3XHU3RUVEXHU1OTU0XHU4REQxXHUwMEEwXHU3QTdGXHU4RDhBXHU5OENFXHU2NkI0XHUwMEEwXHU1NzI4XHU5OENFXHU3NzNDXHU0RTRCXHU0RTJEXHU2MjdFXHU1MjMwXHU1QjgxXHU5NzU5Il0sWyIgIl0sWyJcdTdFRTdcdTdFRURcdTU5NTRcdThERDFcdTAwQTBcdTdBN0ZcdThEOEFcdTk4Q0VcdTY2QjRcdTAwQTBcdTU3MjhcdTk4Q0VcdTc3M0NcdTRFNEJcdTRFMkRcdTYyN0VcdTUyMzBcdTVCODFcdTk3NTkiXSxbIiAiXSxbIlx1NEUwRFx1ODk4MVx1NTA1Q1x1NkI2Mlx1ODExQVx1NkI2NSJdLFsiICJdLFsiXHU2MjExXHU0RUVDXHU4OTg2XHU3MDZEXHU5MUNEXHU3NTFGIl0sWyJcdTU3MjhcdTY1RTBcdTU4RjBcdTY1RTBcdTVGNzFcdTc2ODRcdTlFRDFcdTU5MUMiXSxbIlx1NzBDOFx1NzA2Qlx1NzFDRVx1NTM5RiJdLFsiXHU0RTBEXHU1M0VGXHU5NjNCXHU2MzIxIl0sWyJcdTVDMzFcdTdCOTdcdTkwNkRcdTRFQkFcdThGN0JcdTg5QzYiXSxbIlx1NUMzMVx1N0I5N1x1NkJFQlx1NjVFMFx1ODBEQ1x1N0I5N1x1MDBBMFx1NEU1Rlx1ODk4MVx1N0VERFx1NTczMFx1NTNDRFx1NTFGQiJdLFsiXHU4OTg2XHU3MDZEXHU5MUNEXHU3NTFGIl0sWyJcdTYyMTFcdTcwQjlcdTcxQzNcdTkxQ0VcdTcwNkJcdTUxQjJcdTY1NjNcdTlFRDFcdTU5MUMiXSxbIlx1NTcyOFx1NjVFMFx1NUMzRFx1NzY4NFx1NjcyQVx1NzdFNVx1NEUyRFx1NjI3RVx1NUJGQlx1ODFFQVx1NURGMSJdLFsiXHU4RkZEXHU5MDEwXHU3NzQwXHU2NjFGXHU1QkJGXHU1NDhDXHU1MTQ5Il0sWyJcdTc1MjhcdTVDM0RcdTUxNjhcdTUyOUJcdTU5NTRcdThERDFcdThGRkRcdTVCRkIiXSxbIlx1OTBBM1x1OEZGN1x1NTkzMVx1NTcyOFx1N0E3QVx1NkQxRVx1OTFDQ1x1NzY4NFx1NzcxRlx1NzQwNiJdLFsiXHU1NEVBXHU2MDE1XHU1MjREXHU5MDE0XHU4MzQ2XHU2OEQ4XHU2RjJCXHU2RjJCIl0sWyJcdTU0RUFcdTYwMTVcdTVGNTJcdThERUZcdTVFMENcdTY3MUJcdTZFM0FcdTgzMkIiXSxbIlx1NTcyOFx1NTkzMVx1NUU4Rlx1NzY4NFx1N0E3QVx1NkQxRVx1OTFDQ1x1OTFDRFx1NjVCMFx1NUYwMFx1NTlDQiJdLFsiXHU2MjExXHU0RUVDXHU3RUM4XHU1QzA2XHU1MUIyXHU3ODM0XHU0RTAwXHU1MjA3XHU5NjNCXHU3ODhEXHUwMEEwXHU2MjExXHU3Njg0XHU0RjE5XHU0RjM0Il0sWyJcdTU5NTRcdThERDFcdTU0MjciXSxbIlx1NjIxMVx1NEVFQ1x1N0VDOFx1NUMwNlx1NTFCMlx1NzgzNFx1OTYzQlx1Nzg4RCJdLFsiXHU5MUNBXHU2NTNFXHU1NDI3Il0sWyJcdTYyMTFcdTRFRUNcdTdFQzhcdTVDMDZcdThENzBcdTUxRkFcdThGRjdcdTYwRDgiXV0sInR5cGUiOjF9XSwidmVyc2lvbiI6MX0=]
[0,728]<0,60,0>覆<60,60,0>灭<120,60,0>重<180,60,0>生<240,60,0> <300,60,0>Come <360,60,0>Alive - <420,60,0>三<480,60,0>Z-<540,60,0>STUDIO/<600,60,0>HOYO-<660,60,0>MiX
[729,364]<0,60,0>制<60,60,0>作<120,60,0>人<180,60,0>：<240,60,0>雷<300,60,0>声
[1094,424]<0,60,0>作<60,60,0>词<120,60,0>：<180,60,0>Philip <240,60,0>Strand/<300,60,0>雷<360,60,0>声
[1519,424]<0,60,0>作<60,60,0>曲<120,60,0>：<180,60,0>Philip <240,60,0>Strand/<300,60,0>雷<360,60,0>声
[1944,303]<0,60,0>编<60,60,0>曲<120,60,0>：<180,60,0>雷<240,60,0>声
[2248,485]<0,60,0>吉<60,60,0>他<120,60,0>贝<180,60,0>斯<240,60,0>鼓<300,60,0>：<360,60,0>因<420,60,0>可
[2734,364]<0,60,0>混<60,60,0>音<120,60,0>：<180,60,0>郑<240,60,0>仕<300,60,0>伟
[3098,364]<0,60,0>母<60,60,0>带<120,60,0>：<180,60,0>郑<240,60,0>仕<300,60,0>伟
[3463,720]<0,352,0>How <352,368,0>long
[4527,1352]<0,207,0>Can <207,225,0>we <432,328,0>stay <760,592,0>awake
[6111,1079]<0,184,0>Watch <184,167,0>it <351,345,0>all <696,383,0>fall
[7190,1737]<0,209,0>Yeah <209,167,0>we <376,161,0>watch <537,184,0>it <721,384,0>all <1105,632,0>break
[9398,841]<0,361,0>How <361,480,0>long
[10527,2659]<0,200,0>Till <200,208,0>we <408,290,0>all <698,760,0>fade <1458,1201,0>away
[15441,801]<0,320,0>How <320,481,0>deep
[16522,1496]<0,200,0>Are <200,208,0>we <408,367,0>gonna <775,721,0>sink
[18378,784]<0,168,0>Before <168,240,0>we <408,192,0>know <600,184,0>it
[19162,1847]<0,215,0>We've <215,201,0>been <416,321,0>losing <737,399,0>our <1136,711,0>dreams
[21394,1048]<0,400,0>How <400,648,0>deep
[22442,2736]<0,255,0>Before <255,218,0>we <473,376,0>all <849,687,0>fade <1536,1200,0>away
[26162,1087]<0,184,0>So <184,177,0>where <361,183,0>do <544,128,0>we <672,415,0>go
[27249,1250]<0,161,0>不<161,183,0>知<344,216,0>道<560,203,0>从<763,173,0>哪<936,118,0>天<1054,196,0>起
[28723,1625]<0,168,0>墙<168,192,0>上<360,184,0>的<544,184,0>电<728,220,0>视<948,176,0>机<1124,501,0>里
[30348,198]<0,33,0>(<33,33,0>And <66,35,0>where <101,32,0>is <133,32,0>your <165,33,0>heart)
[30546,2104]<0,34,0>播<34,106,0>报<140,144,0>有<284,184,0>人<468,183,0>迷<651,177,0>失<828,168,0>在<996,185,0>空<1181,207,0>洞<1388,215,0>陷<1603,501,0>阱
[32650,165]<0,33,0>(<33,32,0>Show <65,33,0>me <98,34,0>the <132,33,0>light)
[32815,963]<0,32,0>无<32,34,0>法<66,34,0>忍<100,343,0>受<443,152,0>的<595,175,0>沉<770,193,0>默
[33778,1519]<0,183,0>代<183,176,0>理<359,217,0>委<576,335,0>托<911,193,0>的<1104,207,0>生<1311,208,0>活
[35297,1763]<0,184,0>对<184,185,0>抗<369,199,0>堕<568,335,0>落<903,176,0>的<1079,184,0>困<1263,500,0>兽
[37060,132]<0,33,0>(<33,33,0>Over <66,35,0>and <101,31,0>over)
[37192,1367]<0,32,0>找<32,101,0>寻<133,136,0>逃<269,212,0>脱<481,208,0>的<689,177,0>绳<866,501,0>索
[38559,130]<0,31,0>(<31,33,0>Over <64,33,0>and <97,33,0>over)
[38689,2537]<0,33,0>向<33,33,0>着<66,33,0>吹<99,414,0>过<513,193,0>冷<706,182,0>冽<888,209,0>的<1097,192,0>风<1289,176,0>它<1465,176,0>带<1641,184,0>走<1825,184,0>我<2009,231,0>的<2240,297,0>manic
[41466,2036]<0,225,0>抛<225,166,0>去<391,184,0>狂<575,185,0>妄<760,184,0>自<944,160,0>大<1104,191,0>的<1295,177,0>偏<1472,227,0>执<1699,1,0>的<1699,176,0>想<1875,161,0>法
[43502,799]<0,136,0>和<136,160,0>现<296,160,0>实<456,151,0>对<607,192,0>垒
[44518,1954]<0,135,0>越<135,177,0>过<312,192,0>这<504,175,0>台<679,123,0>阶<802,143,0> <945,160,0>去<1105,167,0>寻<1272,185,0>找<1457,192,0>那<1649,160,0>规<1809,145,0>则
[46713,880]<0,215,0>It's <215,361,0>like <576,304,0>magic
[47881,1664]<0,192,0>举<192,129,0>起<321,143,0>火<464,136,0>把<600,160,0>点<760,152,0>燃<912,168,0>驱<1080,199,0>散<1279,193,0>晦<1472,192,0>涩
[49721,1279]<0,208,0>All <208,144,0>I <352,391,0>wanna <743,536,0>say
[51231,1889]<0,161,0>We <161,162,0>all <323,166,0>have <489,152,0>the <641,287,0>same <928,961,0>desire
[53120,2128]<0,199,0>I <199,441,0>come <640,1488,0>alive
[55576,3515]<0,168,0>Burn <168,306,0>in <474,224,0>the <698,384,0>night <1082,336,0>like <1418,2097,0>wildfire
[59378,1890]<0,175,0>Find <175,137,0>me <312,160,0>in <472,200,0>the <672,329,0>great <1001,889,0>unknown
[61268,2873]<0,232,0>I'm <232,992,0>following <1224,369,0>the <1593,1280,0>stars
[64990,3695]<0,279,0>Swear <279,368,0>I <647,424,0>will <1071,352,0>run <1423,175,0>until <1598,215,0>I <1813,201,0>run <2014,192,0>out <2206,192,0>of <2398,305,0>air <2703,209,0>in <2912,351,0>my <3263,432,0>lungs
[68988,3414]<0,384,0>Fighting <384,233,0>for <617,168,0>the <785,225,0>ones <1010,185,0>that <1195,198,0>are <1393,292,0>lost <1685,369,0>in <2054,231,0>the <2285,1129,0>hollow
[72402,4635]<0,193,0>I <193,543,0>know <736,239,0>it's <975,497,0>hard <1472,256,0>to <1728,449,0>see <2177,280,0>it <2457,2178,0>end
[78430,3818]<0,360,0>We're <360,744,0>gonna <1104,335,0>make <1439,193,0>it <1632,368,0>out <2000,391,0>my <2391,1427,0>friend
[82781,1128]<0,138,0>成<138,159,0>长<297,176,0>的<473,192,0>所<665,463,0>谓
[84206,1218]<0,168,0>擦<168,216,0>干<384,215,0>那<599,177,0>眼<776,442,0>泪
[85678,2304]<0,209,0>不<209,167,0>待<376,177,0>见<553,167,0>的<720,144,0>看<864,152,0>法<1016,159,0>只<1175,168,0>是<1343,169,0>生<1512,144,0>活<1656,144,0>的<1800,160,0>点<1960,344,0>缀
[87982,2048]<0,144,0>我<144,184,0>看<328,183,0>过<511,193,0>街<704,184,0>头<888,176,0>泛<1064,184,0>黄<1248,135,0>被<1383,153,0>涂<1536,152,0>鸦<1688,128,0>的<1816,120,0>墙<1936,112,0>上
[90030,683]<0,136,0>画<136,136,0>着<272,128,0>漫<400,26,0>天<426,143,0>星<569,114,0>斗
[90945,1609]<0,144,0>也<144,136,0>感<280,144,0>受<424,192,0>过<616,136,0>随<752,135,0>便<887,128,0>潦<1015,44,0>草<1059,118,0>几<1177,184,0>行<1361,135,0>的<1496,112,0>谎<1608,1,0>言
[92554,1417]<0,120,0>抛<120,112,0>出<232,103,0>就<335,105,0>可<440,144,0>以<584,128,0>变<712,112,0>成<824,128,0>锋<952,152,0>利<1104,98,0>匕<1202,215,0>首
[93971,2010]<0,161,0>历<161,208,0>经<369,216,0>着<585,183,0>生<768,160,0>离<928,127,0>死<1055,113,0>别<1168,120,0>存<1288,113,0>亡<1401,119,0>的<1520,128,0>困<1648,33,0>兽<1681,168,0>之<1849,161,0>斗
[96206,1137]<0,184,0>管<184,192,0>它<376,200,0>能<576,191,0>不<767,193,0>能<960,177,0>活
[97574,1566]<0,169,0>全<169,176,0>力<345,160,0>以<505,129,0>赴<634,1,0>地<903,152,0>支<1055,184,0>援<1239,152,0>朋<1391,175,0>友
[99285,1034]<0,152,0>哪<152,192,0>怕<344,192,0>它<536,175,0>侵<711,155,0>蚀<866,168,0>我
[100519,2272]<0,168,0>支<168,200,0>离<368,175,0>破<543,144,0>碎<687,153,0>的<840,136,0>身<976,184,0>体<1160,160,0>变<1320,192,0>得<1512,184,0>不<1696,191,0>能<1887,177,0>掌<2064,208,0>控
[102974,385]<0,195,0>哪<195,190,0>怕
[103543,2255]<0,168,0>面<168,184,0>目<352,176,0>全<528,136,0>非<664,152,0>的<816,152,0>身<968,184,0>体<1152,177,0>变<1329,191,0>得<1520,168,0>不<1688,176,0>能<1864,168,0>掌<2032,223,0>控
[105983,541]<0,168,0>管<168,192,0>他<360,181,0>的
[106524,1921]<0,335,0>我<335,362,0>也<697,391,0>绝<1088,256,0>不<1344,344,0>退<1688,233,0>让
[108445,2209]<0,329,0>I <329,448,0>come <777,1432,0>alive
[111062,3721]<0,231,0>Burn <231,305,0>in <536,216,0>the <752,360,0>night <1112,376,0>like <1488,2233,0>wildfire
[114783,2043]<0,192,0>Find <192,200,0>me <392,168,0>in <560,224,0>the <784,331,0>great <1115,928,0>unknown
[116826,3027]<0,201,0>I'm <201,1015,0>following <1216,360,0>the <1576,1451,0>stars
[120373,3848]<0,425,0>Swear <425,375,0>I <800,377,0>will <1177,335,0>run <1512,200,0>until <1712,208,0>I <1920,289,0>run <2209,119,0>out <2328,176,0>of <2504,384,0>air <2888,256,0>in <3144,232,0>my <3376,472,0>lungs
[124540,3367]<0,345,0>Fighting <345,208,0>for <553,192,0>the <745,240,0>ones <985,144,0>that <1129,208,0>are <1337,306,0>lost <1643,320,0>in <1963,240,0>the <2203,1164,0>hollow
[127907,4630]<0,224,0>I <224,496,0>know <720,224,0>it's <944,532,0>hard <1476,240,0>to <1716,472,0>see <2188,288,0>it <2476,2154,0>end
[133953,5476]<0,360,0>We're <360,693,0>gonna <1053,362,0>make <1415,366,0>it <1781,195,0>out <1976,397,0>my <2373,3103,0>friend
[142910,2716]<0,160,0>You <160,161,0>better <321,208,0>run <529,209,0>you <738,382,0>better <1120,230,0>hide <1350,377,0>inside <1727,206,0>the <1933,186,0>eye <2119,174,0>of <2293,193,0>the <2486,230,0>storm
[145626,3112]<0,200,0>哪<200,224,0>怕<424,225,0>我<649,191,0>身<840,184,0>体<1024,184,0>变<1208,176,0>得<1384,200,0>面<1584,192,0>目<1776,199,0>全<1975,209,0>非<2184,199,0>不<2383,185,0>能<2568,200,0>掌<2768,344,0>控
[148738,2995]<0,200,0>You <200,328,0>better <528,216,0>run <744,223,0>you <967,272,0>better <1239,249,0>hide <1488,352,0>inside <1840,216,0>the <2056,192,0>eye <2248,191,0>of <2439,208,0>the <2647,348,0>storm
[151733,2970]<0,160,0>哪<160,185,0>怕<345,207,0>我<552,208,0>身<760,226,0>体<986,191,0>变<1177,225,0>得<1402,184,0>面<1586,168,0>目<1754,160,0>全<1914,183,0>非<2097,186,0>不<2283,167,0>能<2450,200,0>掌<2650,320,0>控
[154894,3262]<0,154,0>You <154,239,0>better <393,207,0>run <600,201,0>you <801,336,0>better <1137,217,0>hide <1354,344,0>inside <1698,199,0>the <1897,192,0>eye <2089,183,0>of <2272,200,0>the <2472,790,0>storm
[163276,368]<0,368,0>Run
[168411,2510]<0,161,0>You <161,172,0>better <333,201,0>hide <534,184,0>you <718,400,0>better <1118,1392,0>run
[172553,1576]<0,1576,0>RUN
[174377,1890]<0,144,0>We <144,232,0>come <376,424,0>alive <800,344,0>come <1144,746,0>alive
[176643,1690]<0,168,0>In <168,248,0>the <416,179,0>dead <595,160,0>of <755,232,0>the <987,703,0>night
[178613,1434]<0,313,0>Spread <313,367,0>like <680,754,0>wildfire
[180047,1438]<0,367,0>Circle <367,224,0>you <591,847,0>out
[181909,2616]<0,608,0>Call <608,337,0>us <945,198,0>the <1143,1473,0>underdogs
[184757,1931]<0,184,0>Fighting <184,160,0>in <344,152,0>the <496,754,0>silence <1250,369,0>beat <1619,175,0>the <1794,137,0>odds
[186688,1826]<0,144,0>I <144,411,0>come <555,1271,0>alive
[188809,3584]<0,360,0>Burn <360,320,0>in <680,256,0>the <936,384,0>night <1320,376,0>like <1696,1888,0>wildfire
[192809,1879]<0,304,0>Find <304,128,0>me <432,176,0>in <608,168,0>the <776,383,0>great <1159,720,0>unknown
[194688,3307]<0,265,0>I'm <265,1127,0>following <1392,224,0>the <1616,1691,0>stars
[198403,3727]<0,391,0>Swear <391,346,0>I <737,341,0>will <1078,248,0>run <1326,323,0>until <1649,214,0>I <1863,132,0>run <1995,201,0>out <2196,234,0>of <2430,341,0>air <2771,217,0>in <2988,344,0>my <3332,395,0>lungs
[202514,3356]<0,368,0>Fighting <368,184,0>for <552,191,0>the <743,233,0>ones <976,152,0>that <1128,207,0>are <1335,388,0>lost <1723,328,0>in <2051,231,0>the <2282,1074,0>hollow
[205870,4570]<0,206,0>I <206,545,0>know <751,249,0>it's <1000,503,0>hard <1503,202,0>to <1705,406,0>see <2111,393,0>it <2504,2066,0>end
[211912,4447]<0,320,0>I <320,376,0>know <696,392,0>it's <1088,368,0>hard <1456,200,0>to <1656,320,0>see <1976,399,0>it <2375,2072,0>end
[218025,5306]<0,655,0>Inside <655,352,0>the <1007,527,0>hollow <1534,376,0>we <1910,3396,0>begain
[224003,3651]<0,303,0>We're <303,684,0>gonna <987,352,0>make <1339,208,0>it <1547,375,0>out <1922,392,0>my <2314,1337,0>friend
[228086,3008]<0,3008,0>RUN
[231574,2456]<0,199,0>We're <199,371,0>gonna <570,192,0>make <762,250,0>it <1012,346,0>out <1358,463,0>my <1821,323,0>friend
[234030,2612]<0,2612,0>RUN
[237242,3001]<0,209,0>We're <209,327,0>gonna <536,352,0>make <888,361,0>it <1249,448,0>out <1697,400,0>my <2097,592,0>friend
        """.trimIndent().split("\n")
        val result = KugouKrcParser.parse(krc)
        // 验证解析出的行数 (100行主歌词和翻译)
        assertEquals(100, result.lines.size)

        // 行按时间排序
        val nineLine = result.lines[8] as KaraokeLine
        val tenLine = result.lines[9] as KaraokeLine
        val jiuShiJiuLine = result.lines[99] as KaraokeLine

        // 验证第九行翻译
        assertEquals("还能", nineLine.translation?.trim())

        // 验证第十行翻译
        assertEquals("抵抗多久？", tenLine.translation?.trim())

        // 验证第九行是否解析正确
        assertEquals("How ",nineLine.syllables[0].content)

        // 验证第十行是否解析正确
        assertEquals("Can ",tenLine.syllables[0].content)

        // 验证九十九行翻译
        assertEquals("我们终将走出迷惘",jiuShiJiuLine.translation?.trim())

        //验证九十九行第三个
        assertEquals("make ",jiuShiJiuLine.syllables[2].content)

    }

    @Test
    fun testKugouKrcSpacing() {
        val krc = """
            [ti:绝世舞姬]
            [ar:张晓涵/戚琦/戚琦]
            [al:绝世舞姬]
            [by:]
            [offset:0]
            [0,880]<0,67,0>绝<67,68,0>世<135,68,0>舞<203,67,0>姬<270,68,0> <338,68,0>-<406,67,0> <473,68,0>张<541,68,0>曦<609,67,0>匀<676,68,0>/<744,68,0>戚<812,68,0>琦
            [882,882]<0,147,0>词<147,147,0>：<294,147,0>清<441,147,0>玄<588,147,0>小<735,147,0>仙
            [1764,882]<0,176,0>曲<176,176,0>：<352,176,0>房<528,176,0>雪<704,176,0>娇
            [2646,882]<0,110,0>Rap<110,110,0>编<220,110,0>写<330,110,0> <440,110,0>Rap <550,110,0>Arrangement：<660,110,0>顾<770,110,0>雄
            [3528,882]<0,147,0>编<147,147,0>曲<294,147,0> <441,147,0>Arranger：<588,147,0>甘<735,147,0>虎
            [4410,882]<0,80,0>制<80,80,0>作<160,80,0>人<240,80,0> <320,80,0>Producer：<400,80,0>顾<480,80,0>雄<560,80,0>/<640,80,0>胡<720,80,0>小<800,80,0>健
            [5292,882]<0,98,0>和<98,98,0>声<196,98,0>编<294,98,0>写<392,98,0> <490,98,0>Harmony <588,98,0>Arrangement：<686,98,0>曾<784,98,0>婕
            [6174,882]<0,88,0>和<88,88,0>声<176,88,0> <264,88,0>Harmony <352,88,0>Vocals：<440,88,0>曾<528,88,0>婕<616,88,0>/<704,88,0>顾<792,88,0>雄
            [7056,882]<0,73,0>人<73,73,0>声<146,73,0>录<219,73,0>音<292,73,0>工<365,73,0>程<438,73,0>师<511,73,0> <584,73,0>Recording <657,73,0>Engineer：<730,73,0>顾<803,73,0>雄
            [7938,882]<0,51,0>人<51,51,0>声<102,51,0>录<153,51,0>音<204,51,0>室<255,51,0> <306,51,0>Vocal <357,51,0>Recording <408,51,0>Studio：<459,51,0>华<510,51,0>音<561,51,0>·<612,51,0>鼎<663,51,0>天<714,51,0>录<765,51,0>音<816,51,0>棚
            [8820,882]<0,88,0>混<88,88,0>音<176,88,0>工<264,88,0>程<352,88,0>师<440,88,0> <528,88,0>Mixing <616,88,0>Engineer：<704,88,0>顾<792,88,0>雄
            [9702,882]<0,98,0>母<98,98,0>带<196,98,0>工<294,98,0>程<392,98,0>师<490,98,0> <588,98,0>Mastering：<686,98,0>顾<784,98,0>雄
            [10584,882]<0,98,0>封<98,98,0>面<196,98,0>设<294,98,0>计<392,98,0> <490,98,0>Cover <588,98,0>Design：<686,98,0>路<784,98,0>畅
            [11466,882]<0,110,0>出<110,110,0>品<220,110,0>人<330,110,0> <440,110,0>Publisher：<550,110,0>胡<660,110,0>小<770,110,0>健
            [12348,882]<0,294,0>戚<294,294,0>琦<588,294,0>：
            [13230,2249]<0,448,0>绝<448,456,0>世<904,320,0>舞<1224,1025,0>姬
            [15479,3616]<0,623,0>天<623,824,0>下<1447,2169,0>先
            [19686,4220]<0,224,0>张<224,192,0>晓<416,328,0>涵<744,3476,0>：
            [23906,2439]<0,223,0>烽<223,200,0>烟<423,224,0>燃<647,448,0>起<1075,0,0> <1095,264,0>乱<1359,248,0>风<1607,832,0>华
            [26673,2368]<0,184,0>胭<184,184,0>脂<368,177,0>落<545,335,0>泪<860,0,0> <880,192,0>染<1072,343,0>红<1415,953,0>霞
            [29321,2368]<0,193,0>眉<193,167,0>目<360,200,0>如<560,488,0>画<1028,0,0> <1048,207,0>宜<1255,240,0>其<1495,289,0>室<1784,584,0>家
            [31689,2672]<0,200,0>说<200,152,0>陪<352,168,0>我<520,192,0>浪<712,175,0>迹<887,241,0>天<1128,224,0>涯<1332,0,0> <1352,208,0>都<1560,208,0>作<1768,904,0>假
            [34594,2463]<0,215,0>心<215,168,0>死<383,192,0>就<575,312,0>在<867,0,0> <887,231,0>那<1118,305,0>一<1423,1040,0>刹
            [37329,2528]<0,192,0>世<192,247,0>间<439,200,0>安<639,209,0>得<828,0,0> <848,208,0>双<1056,312,0>全<1368,1160,0>法
            [39857,2469]<0,304,0>眸<304,248,0>中<552,280,0>无<832,376,0>他<1188,0,0> <1208,200,0>便<1408,224,0>无<1632,366,0>冬<1998,471,0>夏
            [42326,712]<0,192,0>君<192,184,0>临<376,137,0>天<513,199,0>下
            [43038,1978]<0,177,0>也<177,144,0>只<321,177,0>能<498,279,0>道<777,200,0>一<977,208,0>声<1165,0,0> <1185,793,0>寡
            [45263,2552]<0,224,0>若<224,344,0>我<568,248,0>一<816,248,0>舞<1064,208,0>断<1272,288,0>杀<1560,992,0>伐
            [47815,2768]<0,224,0>兵<224,193,0>临<417,199,0>城<616,336,0>下<952,216,0>万<1168,376,0>箭<1544,1224,0>发
            [50583,2019]<0,193,0>若<193,175,0>我<368,168,0>一<536,288,0>舞<824,256,0>定<1080,540,0>天<1620,399,0>下
            [52602,4106]<0,184,0>在<184,208,0>你<392,281,0>方<673,303,0>寸<976,208,0>棋<1184,393,0>盘<1577,440,0>倒<2017,305,0>也<2322,1784,0>罢
            [57172,3796]<0,208,0>戚<208,208,0>琦<416,3380,0>：
            [60968,2559]<0,329,0>美<329,239,0>人<568,199,0>舞<767,256,0>如<1023,265,0>莲<1288,711,0>花<1999,560,0>旋
            [63527,2710]<0,208,0>世<208,343,0>人<551,224,0>见<775,583,0>之<1358,329,0>惊<1687,231,0>且<1918,792,0>叹
            [66237,2368]<0,376,0>一<376,248,0>曲<624,225,0>终<849,439,0>了<1288,329,0>与<1617,207,0>君<1824,544,0>断
            [68605,2896]<0,218,0>绝<218,206,0>世<424,256,0>舞<680,280,0>姬<960,256,0>天<1216,288,0>下<1504,1392,0>先
            [71749,2369]<0,224,0>美<224,224,0>人<448,249,0>舞<697,351,0>如<1048,257,0>清<1305,327,0>泉<1632,737,0>涧
            [74118,2847]<0,327,0>世<327,384,0>人<711,208,0>见<919,400,0>之<1319,208,0>惊<1527,305,0>且<1832,1015,0>叹
            [76965,2464]<0,344,0>剪<344,248,0>不<592,248,0>断<840,416,0>的<1256,200,0>理<1456,304,0>还<1760,704,0>乱
            [79429,2736]<0,216,0>绝<216,193,0>世<409,223,0>舞<632,312,0>姬<944,176,0>天<1120,288,0>下<1408,1328,0>先
            [82461,10608]<0,200,0>张<200,184,0>晓<384,10224,0>涵<10608,0,0>：
            [93069,3016]<0,384,0>烽<384,384,0>烟<768,232,0>燃<1000,368,0>起<1348,0,0> <1368,208,0>乱<1576,216,0>风<1792,1224,0>华
            [96085,2441]<0,216,0>胭<216,216,0>脂<432,242,0>落<674,262,0>泪<916,0,0> <936,224,0>染<1160,288,0>红<1448,993,0>霞
            [98749,2272]<0,184,0>眉<184,184,0>目<368,208,0>如<576,456,0>画<1012,0,0> <1032,200,0>宜<1232,216,0>其<1448,440,0>室<1888,384,0>家
            [101021,2728]<0,168,0>说<168,160,0>陪<328,168,0>我<496,184,0>浪<680,200,0>迹<880,168,0>天<1048,248,0>涯<1276,0,0> <1296,184,0>都<1480,225,0>作<1705,1023,0>假
            [103957,2528]<0,192,0>若<192,176,0>我<368,232,0>一<600,297,0>舞<897,167,0>断<1064,320,0>杀<1384,1144,0>伐
            [106485,2703]<0,248,0>兵<248,184,0>临<432,218,0>城<650,334,0>下<984,256,0>万<1240,438,0>箭<1678,1025,0>发
            [109188,2127]<0,223,0>若<223,184,0>我<407,200,0>一<607,352,0>舞<959,455,0>定<1414,376,0>天<1790,337,0>下
            [111315,1574]<0,183,0>在<183,216,0>你<399,232,0>方<631,272,0>寸<903,199,0>棋<1102,472,0>盘
            [112889,3537]<0,249,0>倒<249,615,0>也<864,2673,0>罢
            [116641,545]<0,200,0>戚<200,345,0>琦<545,0,0>：
            [117186,2488]<0,215,0>美<215,241,0>人<456,256,0>舞<712,287,0>如<999,208,0>莲<1207,353,0>花<1560,928,0>旋
            [119674,2583]<0,320,0>世<320,223,0>人<543,257,0>见<800,367,0>之<1167,161,0>惊<1328,376,0>且<1704,879,0>叹
            [122257,2280]<0,369,0>一<369,224,0>曲<593,265,0>终<858,383,0>了<1241,192,0>与<1433,368,0>君<1801,479,0>断
            [124537,3057]<0,192,0>绝<192,200,0>世<392,192,0>舞<584,377,0>姬<961,288,0>天<1249,336,0>下<1585,1472,0>先
            [127594,2832]<0,416,0>美<416,184,0>人<600,312,0>舞<912,407,0>如<1319,377,0>清<1696,327,0>泉<2023,809,0>涧
            [130426,2496]<0,296,0>世<296,232,0>人<528,303,0>见<831,288,0>之<1119,177,0>惊<1296,328,0>且<1624,872,0>叹
            [132922,2417]<0,392,0>剪<392,352,0>不<744,280,0>断<1024,344,0>的<1368,215,0>理<1583,506,0>还<2089,328,0>乱
            [135339,2157]<0,168,0>绝<168,168,0>世<336,176,0>舞<512,424,0>姬<936,184,0>天<1120,452,0>下<1572,585,0>先
            [137496,439]<0,160,0>张<160,135,0>晓<295,144,0>涵<439,0,0>：
            [137935,1370]<0,144,0>烽<144,153,0>烟<277,0,0> <297,160,0>燃<457,240,0>起<697,247,0>了<944,144,0>风<1088,282,0>华
            [139305,1215]<0,158,0>胭<158,144,0>脂<282,0,0> <302,161,0>染<463,160,0>泪<623,168,0>染<791,184,0>红<975,240,0>霞
            [140520,1416]<0,160,0>眉<160,160,0>目<320,152,0>如<472,223,0>画<675,0,0> <695,177,0>宜<872,160,0>其<1032,159,0>室<1191,225,0>家
            [141936,1231]<0,175,0>我<175,137,0>陪<312,169,0>你<481,151,0>浪<632,160,0>迹<792,168,0>天<960,271,0>涯
            [143167,1176]<0,176,0>心<176,169,0>死<345,159,0>在<504,169,0>一<673,207,0>刹<880,296,0>那
            [144343,1392]<0,177,0>世<177,176,0>间<353,167,0>安<520,192,0>得<712,184,0>双<896,168,0>全<1064,328,0>法
            [145735,736]<0,168,0>眸<168,152,0>中<320,176,0>无<496,240,0>他
            [146471,776]<0,217,0>君<217,167,0>临<384,169,0>天<553,223,0>下
            [147247,1577]<0,176,0>只<176,184,0>能<360,160,0>道<520,168,0>一<688,184,0>声<872,705,0>寡
            [148824,503]<0,208,0>血<208,295,0>溅
            [149327,2464]<0,169,0>尸<169,184,0>骸<353,200,0>踏<553,239,0>燃<792,234,0>起<1026,278,0>风<1304,1160,0>沙
            [151791,2477]<0,296,0>兵<296,200,0>临<496,184,0>城<680,240,0>下<920,200,0>万<1120,517,0>箭<1637,840,0>发
            [154268,2288]<0,360,0>三<360,192,0>千<552,240,0>鸦<792,423,0>杀<1195,0,0> <1215,192,0>它<1407,185,0>终<1592,176,0>是<1768,193,0>虚<1961,327,0>话
            [156556,840]<0,192,0>绝<192,168,0>世<360,176,0>舞<536,304,0>姬
            [157396,1897]<0,216,0>此<216,249,0>生<465,271,0>已<736,224,0>了<960,232,0>无<1192,200,0>牵<1392,505,0>挂
            [159293,335]<0,175,0>戚<175,160,0>琦<335,0,0>：
            [159628,2608]<0,232,0>美<232,176,0>人<408,256,0>舞<664,376,0>如<1040,224,0>莲<1264,417,0>花<1681,927,0>旋
            [162236,2528]<0,248,0>世<248,384,0>人<632,194,0>见<826,390,0>之<1216,240,0>惊<1456,545,0>且<2001,527,0>叹
            [164764,2337]<0,353,0>一<353,368,0>曲<721,192,0>终<913,360,0>了<1273,272,0>与<1545,256,0>君<1801,536,0>断
            [167101,3008]<0,199,0>绝<199,210,0>世<409,223,0>舞<632,313,0>姬<945,207,0>天<1152,360,0>下<1512,1496,0>先
            [170341,2395]<0,192,0>美<192,403,0>人<595,200,0>舞<795,224,0>如<1019,265,0>清<1284,295,0>泉<1579,816,0>涧
            [172736,2616]<0,296,0>世<296,305,0>人<601,231,0>见<832,424,0>之<1256,281,0>惊<1537,368,0>且<1905,711,0>叹
            [175352,2529]<0,305,0>剪<305,288,0>不<593,232,0>断<825,271,0>的<1096,408,0>理<1504,489,0>还<1993,536,0>乱
            [177881,3519]<0,232,0>绝<232,183,0>世<415,185,0>舞<600,312,0>姬<912,176,0>天<1088,296,0>下<1384,2135,0>先
        """.trimIndent()

        val result = KugouKrcParser.parse(krc)
        // 验证解析出的行数 (84行主歌词)
        assertEquals(84, result.lines.size)

        val shiWuLine = result.lines[14] as KaraokeLine
        val shiBaiLine = result.lines[17] as KaraokeLine

        // Validate KaraokeAlignment
        assertEquals(KaraokeAlignment.End, shiWuLine.alignment)
        assertEquals(KaraokeAlignment.Start, shiBaiLine.alignment)
    }
}